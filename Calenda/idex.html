<!DOCTYPE html>
<html lang="km">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ប្រព័ន្ធបំលែងថ្ងៃខែឆ្នាំសកលទៅខ្មែរ</title>

    <!-- Include momentkh library -->
    <script src="momentkh/moment.min.js"></script>
    <script src="momentkh/km.min.js"></script>
    <script src="momentkh/constant.js"></script>
    <script src="momentkh/locale/km.js"></script>
    <script src="momentkh/getSoriyatraLerngSak.js"></script>
    <script src="momentkh/momentkh.js"></script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Khmer OS Battambang", "Khmer OS Siemreap", Arial,
          sans-serif;
      }

      body {
        background: linear-gradient(135deg, #fff8dc 0%, #f5f5dc 100%);
        color: #5d4037;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        padding: 30px;
        width: 100%;
        max-width: 600px;
        text-align: center;
      }

      h1 {
        color: #8b4513;
        margin-bottom: 20px;
        font-size: 1.8rem;
      }

      .description {
        color: #a0522d;
        margin-bottom: 25px;
        line-height: 1.5;
      }

      .input-section {
        margin-bottom: 25px;
      }

      .input-group {
        margin-bottom: 15px;
        display: flex;
        gap: 10px;
        justify-content: space-between;
      }

      .input-field {
        flex: 1;
        text-align: left;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #5d4037;
      }

      select {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid rgba(139, 69, 19, 0.3);
        border-radius: 5px;
        font-size: 16px;
        background-color: rgba(255, 248, 220, 0.5);
        cursor: pointer;
      }

      select:focus {
        outline: none;
        border-color: #ff9933;
        box-shadow: 0 0 0 3px rgba(255, 153, 51, 0.2);
      }

      .btn-convert {
        background: linear-gradient(135deg, #ff9933 0%, #cc6600 100%);
        color: white;
        border: none;
        border-radius: 5px;
        padding: 12px 25px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 4px 10px rgba(255, 153, 51, 0.3);
        margin-top: 10px;
        width: 100%;
      }

      .btn-convert:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(255, 153, 51, 0.4);
      }

      .result-section {
        background: linear-gradient(
          135deg,
          rgba(255, 248, 220, 0.7) 0%,
          rgba(255, 240, 200, 0.7) 100%
        );
        border-radius: 10px;
        padding: 20px;
        border: 2px dashed #ff9933;
        margin-top: 20px;
      }

      .result-title {
        font-size: 1rem;
        color: #a0522d;
        margin-bottom: 10px;
      }

      .khmer-date {
        font-size: 1.5rem;
        color: #5d4037;
        font-weight: bold;
        line-height: 1.4;
      }

      .temple-info {
        font-size: 1.5rem;
        color: #5d4037;
        font-weight: bold;
        line-height: 1.4;
        margin-top: 10px;
      }

      .footer {
        text-align: center;
        color: #a0522d;
        font-size: 0.9rem;
        margin-top: 20px;
      }

      @media (max-width: 480px) {
        .input-group {
          flex-direction: column;
          gap: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ប្រព័ន្ធបំលែងថ្ងៃខែឆ្នាំសកលទៅខ្មែរ</h1>

      <div class="description">
        <p>
          បំលែងថ្ងៃខែឆ្នាំសកល (Gregorian) ទៅជាថ្ងៃខែឆ្នាំខ្មែរ (Buddhist)
          បានយ៉ាងងាយស្រួល
        </p>
      </div>

      <div class="input-section">
        <div class="input-group">
          <div class="input-field">
            <label for="daySelect">ថ្ងៃ</label>
            <select id="daySelect">
              <option value="">-- ជ្រើសរើសថ្ងៃ --</option>
              <!-- Days will be populated by JavaScript -->
            </select>
          </div>

          <div class="input-field">
            <label for="monthSelect">ខែ</label>
            <select id="monthSelect">
              <option value="">-- ជ្រើសរើសខែ --</option>
              <!-- Months will be populated by JavaScript -->
            </select>
          </div>

          <div class="input-field">
            <label for="yearSelect">ឆ្នាំ</label>
            <select id="yearSelect">
              <option value="">-- ជ្រើសរើសឆ្នាំ --</option>
              <!-- Years will be populated by JavaScript -->
            </select>
          </div>
        </div>

        <button class="btn-convert" onclick="convertDate()">
          <span>បម្លែង</span>
        </button>
      </div>

      <div class="result-section">
        <div class="result-title">លទ្ធផលបំលែងថ្ងៃខែឆ្នាំ:</div>
        <div class="khmer-date" id="khmer-result">
          ថ្ងៃអាទិត្យ ១២ កើត ខែកត្តិក ឆ្នាំម្សាញ់ សប្តស័ក ពុទ្ធសករាជ ២៥៦៩
        </div>
        <div class="temple-info" id="temple-info">
          វត្តថ្មគោល​, ត្រូវនឹងថ្ងៃទី២ ខែវិច្ឆិកា ឆ្នាំ២០២៥
        </div>
      </div>

      <div class="footer">
        <p>ប្រព័ន្ធបំលែងថ្ងៃខែឆ្នាំសកលទៅខ្មែរ &copy; ២៥៦៩ ពុទ្ធសករាជ</p>
        <p>@អេង ចាន់ធឿន@</p>
      </div>
    </div>

    <script>
      // Initialize moment with the khmer extension
      var moment = momentkh(moment);

      // Function to convert numbers to Khmer numerals
      function toKhmerNumber(num) {
        const khmerDigits = ["០", "១", "២", "៣", "៤", "៥", "៦", "៧", "៨", "៩"];
        return num
          .toString()
          .split("")
          .map((digit) => khmerDigits[parseInt(digit)])
          .join("");
      }

      // Function to populate dropdowns
      function populateDropdowns() {
        const daySelect = document.getElementById("daySelect");
        const monthSelect = document.getElementById("monthSelect");
        const yearSelect = document.getElementById("yearSelect");

        // Clear existing options
        daySelect.innerHTML = '<option value="">-- ជ្រើសរើសថ្ងៃ --</option>';
        monthSelect.innerHTML = '<option value="">-- ជ្រើសរើសខែ --</option>';
        yearSelect.innerHTML = '<option value="">-- ជ្រើសរើសឆ្នាំ --</option>';

        // Populate days (1-31)
        for (let i = 1; i <= 31; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = toKhmerNumber(i);
          if (i === 2) option.selected = true;
          daySelect.appendChild(option);
        }

        // Populate months (1-12)
        for (let i = 1; i <= 12; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = toKhmerNumber(i);
          if (i === 11) option.selected = true;
          monthSelect.appendChild(option);
        }

        // Populate years (1900-2100)
        const currentYear = new Date().getFullYear();
        for (let i = 1900; i <= 2100; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = toKhmerNumber(i);
          if (i === 2025) option.selected = true;
          yearSelect.appendChild(option);
        }
      }

      // Initialize with today's date
      document.addEventListener("DOMContentLoaded", function () {
        populateDropdowns();
        convertDate();
      });

      // Convert date function using momentkh library
      function convertDate() {
        const day = document.getElementById("daySelect").value;
        const month = document.getElementById("monthSelect").value;
        const year = document.getElementById("yearSelect").value;

        // Check if all fields are selected
        if (!day || !month || !year) {
          alert("សូមជ្រើសរើសអោយបានគ្រប់គ្រាន់តាមទម្រង់");
          return;
        }

        // Format date as YYYY-MM-DD for momentkh
        const dateString = `${year}-${month.toString().padStart(2, "0")}-${day
          .toString()
          .padStart(2, "0")}`;

        try {
          // Use momentkh to convert to Khmer date
          const khmerDate = moment(dateString).tokhdate();
          document.getElementById("khmer-result").textContent = khmerDate;

          // Format Gregorian date in Khmer with Khmer numerals
          const date = new Date(dateString);

          // Get Khmer month name
          const khmerMonths = [
            "មករា",
            "កុម្ភៈ",
            "មីនា",
            "មេសា",
            "ឧសភា",
            "មិថុនា",
            "កក្កដា",
            "សីហា",
            "កញ្ញា",
            "តុលា",
            "វិច្ឆិកា",
            "ធ្នូ",
          ];
          const gregorianMonthName = khmerMonths[date.getMonth()];

          // Update temple info with Khmer numerals
          document.getElementById(
            "temple-info"
          ).textContent = `វត្តថ្មគោល​, ត្រូវនឹងថ្ងៃទី${toKhmerNumber(
            day
          )} ខែ${gregorianMonthName} ឆ្នាំ${toKhmerNumber(year)}`;
        } catch (error) {
          console.error("Conversion error:", error);
          alert("មានបញ្ហាក្នុងការបំលែងថ្ងៃខែឆ្នាំ។ សូមពិនិត្យម្តងទៀត!");
        }
      }
    </script>
  </body>
</html>
